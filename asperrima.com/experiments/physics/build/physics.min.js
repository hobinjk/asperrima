/*! physics 2013-06-27 */
function Body(a,b,c,d,e){this.m=a,this.pos=new Vec2(b,c),this.vel=new Vec2(d,e),this.r=2}function Physics(a){a?this.ctx=document.getElementById(a):(this.ctx=document.createElement("canvas"),this.ctx.id=a),this.ctx.width=this.width=640,this.ctx.height=this.height=640,this.ctx=this.ctx.getContext("2d"),this.bodies=[];for(var b=150,c=1e3,d=Math.sqrt(G*c/b)/2,e=1.1,f=5,g=0;f>g;g++){var h=2*g*Math.PI/f,i=Math.cos(h),j=Math.sin(h);this.bodies.push(new Body(c,this.width/2+b*i,this.height/2+b*j,-e*d*j,e*d*i))}console.log(this.start),this.start()}function Vec2(a,b){this.x=a,this.y=b}Body.prototype.update=function(a){this.pos=this.pos.add(this.vel.mul(a))},Body.prototype.draw=function(a){a.fillStyle="rgb(255,164,0)",a.beginPath(),a.arc(this.pos.x,this.pos.y,this.r,0,2*Math.PI),a.fill()},function(){var a=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;window.requestAnimationFrame=a}();var G=50,timeFactor=5;Physics.prototype.start=function(){this.lastStep=Date.now()-1,this.ctx.fillStyle="rgba(0,0,0,1)",this.ctx.fillRect(0,0,this.width,this.height),this.update()},Physics.prototype.update=function(){var a=(Date.now()-this.lastStep)/1e3*timeFactor;this.ctx.fillStyle="rgba(0,0,0,0.01)",this.ctx.fillRect(0,0,this.width,this.height);for(var b=0;b<this.bodies.length;b++)for(var c=this.bodies[b],d=new Vec2(0,0),e=b+1;e<this.bodies.length;e++){var f=this.bodies[e],g=f.pos.sub(c.pos),h=g.magSq(),i=g.normalized(),j=G*c.m*f.m/h,k=j*i.x/c.m,l=j*i.y/c.m;d.x=k,d.y=l,c.vel=c.vel.add(d.mul(a)),f.vel=f.vel.add(d.mul(-a))}for(b=0;b<this.bodies.length;b++)this.bodies[b].update(a),this.bodies[b].draw(this.ctx);this.lastStep=Date.now(),requestAnimationFrame(this.update.bind(this))},Vec2.prototype.mul=function(a){var b=this.x,c=this.y;if(a instanceof Vec2)b*=a.x,c*=a.y;else{if("number"!=typeof a)throw"Invalid Argument";b*=a,c*=a}return new Vec2(b,c)},Vec2.prototype.dot=Vec2.prototype.mul,Vec2.prototype.div=function(a){var b=this.x,c=this.y;if(a instanceof Vec2)b/=a.x,c/=a.y;else{if("number"!=typeof a)throw"Invalid Argument";b/=a,c/=a}return new Vec2(b,c)},Vec2.prototype.add=function(a){var b=this.x,c=this.y;if(a instanceof Vec2)b+=a.x,c+=a.y;else{if("number"!=typeof a)throw"Invalid Argument";b+=a,c+=a}return new Vec2(b,c)},Vec2.prototype.sub=function(a){var b=this.x,c=this.y;if(a instanceof Vec2)b-=a.x,c-=a.y;else{if("number"!=typeof a)throw"Invalid Argument";b-=a,c-=a}return new Vec2(b,c)},Vec2.prototype.mag=function(){return Math.sqrt(this.magSq())},Vec2.prototype.magSq=function(){return this.x*this.x+this.y*this.y},Vec2.prototype.normalized=function(){return this.div(this.mag())};